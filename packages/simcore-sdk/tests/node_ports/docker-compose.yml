version: '3.6'
services:
  storage:
    # build:
    #   context: ../../../../
    #   dockerfile: services/storage/Dockerfile
    #   args:
    #     - DOCKER_GID_ARG=1500
    #   target: production        
    image: services_storage:latest
    ports:
      - 11111:8080
    environment:
      - POSTGRES_ENDPOINT=postgres:5432
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pwd
      - POSTGRES_DB=test
      - POSTGRES_HOST=postgres
      - POSTGRES_PORT=5432
      - S3_ENDPOINT=${S3_ENDPOINT}
      - S3_ACCESS_KEY=${S3_ACCESS_KEY}
      - S3_SECRET_KEY=${S3_SECRET_KEY}
      - S3_BUCKET_NAME=${S3_BUCKET_NAME}
      - RUN_DOCKER_ENGINE_ROOT=1
      - BF_API_SECRET="none"
      - BF_API_KEY="none"
    restart: always
    depends_on: 
      - postgres
      # - minio
  postgres:
    restart: always
    image: postgres:10
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pwd
      - POSTGRES_DB=test
    ports:
      - "5432:5432"
  # monitors databases
  adminer:
    image: adminer
    ports:
      - 18080:8080
    depends_on:
      - postgres