from pathlib import Path

import yaml
from service_integration.compose_spec_model import ComposeSpecification


def test_autogenerated_compose_spec_model(tests_data_dir: Path):

    docker_compose_path = tests_data_dir / "docker-compose-meta.yml"

    # tests if parses valid file
    compose_spec = ComposeSpecification.parse_obj(
        yaml.safe_load(docker_compose_path.read_text())
    )

    assert compose_spec.version == "3.7"

    assert compose_spec.services
    assert len(compose_spec.services) == 3
