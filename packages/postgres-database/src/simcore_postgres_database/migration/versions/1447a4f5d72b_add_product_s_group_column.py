"""add product's group column

Revision ID: 1447a4f5d72b
Revises: fe19b4e93586
Create Date: 2022-12-19 13:44:58.029875+00:00

"""
import sqlalchemy as sa
from alembic import op

# revision identifiers, used by Alembic.
revision = "1447a4f5d72b"
down_revision = "fe19b4e93586"
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column("products", sa.Column("group_id", sa.BigInteger(), nullable=True))
    op.create_unique_constraint(
        "products_group_id_unique_constraint", "products", ["group_id"]
    )
    op.create_foreign_key(
        "fk_products_group_id",
        "products",
        "groups",
        ["group_id"],
        ["gid"],
        onupdate="CASCADE",
        ondelete="SET NULL",
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint("fk_products_group_id", "products", type_="foreignkey")
    op.drop_constraint(
        "products_group_id_unique_constraint", "products", type_="unique"
    )
    op.drop_column("products", "group_id")
    # ### end Alembic commands ###
