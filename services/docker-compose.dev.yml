version: '3.4'
services:
  director:
    build:
      target: development
    volumes:
      - './director:/home/app'
  build-qx-dev:
    build:
      context: .
      dockerfile: _dockerfiles/build-qx/Dockerfile
    volumes:
      - './web-client:/home/node/qxapp'
  webserver-dev:
    build:
      context: .
      dockerfile: _dockerfiles/qxapp/python/Dockerfile-dev
      args:
        serverdir: web-server
    env_file: .env
    ports:
      - '9081:9081'
      - '9082:9082'
    environment:
      - DIRECTOR_HOST=http://director-dev
      - DIRECTOR_PORT=8001
      - SIMCORE_WEB_PORT=9081
    volumes:
      - './web-server:/usr/src/app'
      - './web-client/source-output:/usr/src/app/client'
    depends_on:
      - build-qx-dev
