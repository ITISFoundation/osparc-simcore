version: '3.4'
services:
  client:
    build:      
      context: client
      target: production
      args: 
        VCS_REF: 
        BUILD_DATE:
#-------------------------------------------------------------------- 
  server:
    build:
      context: server
      target: production
      args:
        web_app_port: 9090
        s4l_ip: "172.16.9.89"
        s4l_port_app: 9095
        s4l_port_mod: 9096
        VCS_REF: 
        BUILD_DATE:
      labels: 
        io.simcore.key: '{"key": "simcore/services/dynamic/modeler/webserver"}'
        io.simcore.tag: '{"tag": "${MODELER_VERSION}"}'
        io.simcore.name: '{"name": "modeler"}'
        io.simcore.description: '{"description": "Modeler viewer"}'
        io.simcore.contact: '{"contact": "anderegg@itis.ethz.ch"}'
        io.simcore.authors: '{"authors": [{"name": "Sylvain Anderegg", "email": "anderegg@itis.ethz.ch", "affiliation": "ITIS Foundation"}]}'
        io.simcore.inputs: '{"inputs": [{"key": "input_1", "label": "Entities in", "desc": "List of entities", "type": "file-url", "value": "null"}]}'
        io.simcore.outputs: '{"outputs": [{"key": "output_1", "label": "Entities out", "desc": "List of entities", "type": "file-url", "value": "null"}]}'
        io.simcore.viewer: '{"viewer":{"ip":null, "port":null}}'
        simcore.service.dependencies: '[{"key": "simcore/services/dynamic/modeler/xrpc-worker", "tag": "1.9"}]'
    ports:
      - '8080:9090'
    depends_on:
      - client
#--------------------------------------------------------------------