{
    "$schema": "http://json-schema.org/draft-07/schema#",

    "title": "oSparc Macro Node",
    "description": "Description of an oSparc node macro node template",
    "type": "object",
    "additionalProperties": false,
    "required": [
        "key",
        "version",
        "name",
        "description",
        "authors",
        "contact",
        "inputs",
        "innerNodes"
    ],
    "properties": {
        "key": {
            "type": "string",
            "description": "distinctive name for the node based on the docker registry path",
            "pattern": "^(service)/(computational|dynamic)(/[^\\s/]+)+$",
            "examples": [
                "service/computational/itis/sleeper",
                "service/dynamic/itis/3dviewer"
            ]
        },
        "version": {
            "type": "string",
            "description": "semantic version number",
            "pattern": "^(0|[1-9]\\d*)(\\.(0|[1-9]\\d*)){2}(-(0|[1-9]\\d*|\\d*[-a-zA-Z][-\\da-zA-Z]*)(\\.(0|[1-9]\\d*|\\d*[-a-zA-Z][-\\da-zA-Z]*))*)?(\\+[-\\da-zA-Z]+(\\.[-\\da-zA-Z-]+)*)?$",
            "examples": [
                "1.0.0",
                "0.0.1"
            ]
        },
        "name": {
            "type": "string",
            "description": "short, human readable name for the node",
            "examples": [
                "Fast Counter"
            ]
        },
        "description": {
            "type": "string",
            "description": "human readable description of the purpose of the node",
            "examples": [
                "Our best node type",
                "The mother of all nodes, makes your numbers shine!"
            ]
        },
        "authors": {
            "type": "array",
            "minItems": 1,
            "items": {
                "type": "object",
                "required": ["name", "email"],
                "additionalProperties": false,
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Name of the author",
                        "examples": [
                            "Sun Bak",
                            "Delenn"
                        ]
                    },
                    "email": {
                        "description": "Email address",
                        "type": "string",
                        "format": "email",
                        "examples": [
                            "sun@sense.eight",
                            "deleen@minbar.bab"
                        ]
                    },
                    "affiliation": {
                        "description": "Affiliation of the author",
                        "type": "string",
                        "examples": [
                            "Sense8",
                            "Babylon 5"
                        ]
                    }
                }
            }
        },
        "contact": {
            "type": "string",
            "format": "email",
            "description": "email to correspond to the authors about the node",
            "examples": [
                "lab@net.flix"
            ]
        },
        "inputs": {
            "type": "object",
            "description": "definition of the expected input nodes of this macro node",
            "patternProperties": {
                "^[-_a-zA-Z0-9]+$": {
                    "type": "object",
                    "description": "all the input node types required",
                    "additionalProperties": false,
                    "required": [
                        "displayOrder",
                        "label",
                        "description",
                        "type"
                    ],
                    "properties": {
                        "displayOrder": {
                            "type": "number",
                            "description": "use this to numerically sort the properties for display",
                            "examples": [
                                1,
                                -0.2
                            ]
                        },
                        "label": {
                            "type": "string",
                            "description": "short name for the property",
                            "examples": [
                                "Age"
                            ]
                        },
                        "description": {
                            "type": "string",
                            "description": "description of the property",
                            "examples": [
                                "Age in seconds since 1970"
                            ]
                        },
                        "type": {
                            "type": "string",
                            "description": "distinctive name for the node based on the docker registry path",
                            "pattern": "^(service)/(computational|dynamic)(/[^\\s/]+)+$",
                            "examples": [
                                "service/computational/itis/sleeper",
                                "service/dynamic/itis/3dviewer"
                            ]
                        }
                    }
                }
            }
        },
        "innerNodes": {
            "type": "object",
            "description": "nodes making up the structure of the macro node",
            "patternProperties": {
                "^[-_a-zA-Z0-9]+$": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                      "key",
                      "version",
                      "inputs",
                      "inputNodes",
                      "outputNode"
                    ],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "distinctive name for the node based on the docker registry path",
                            "pattern": "^(service)/(computational|dynamic)(/[^\\s/]+)+$",
                            "examples": [
                                "service/computational/itis/sleeper",
                                "service/dynamic/itis/3dviewer"
                            ]
                        },
                        "version": {
                            "type": "string",
                            "description": "semantic version number",
                            "pattern": "^(0|[1-9]\\d*)(\\.(0|[1-9]\\d*)){2}(-(0|[1-9]\\d*|\\d*[-a-zA-Z][-\\da-zA-Z]*)(\\.(0|[1-9]\\d*|\\d*[-a-zA-Z][-\\da-zA-Z]*))*)?(\\+[-\\da-zA-Z]+(\\.[-\\da-zA-Z-]+)*)?$",
                            "examples": [
                                "1.0.0",
                                "0.0.1"
                            ]
                        },
                        "inputs": {
                            "description": "default configuration of the node. the node type defines the structure of this data",
                            "type": "object"
                        },
                        "inputNodes": {
                            "type": "array",
                            "description": "list of input nodes that feed into this node",
                            "items": {
                                "type": "string",
                                "pattern": "^[-_a-zA-Z0-9]+$",
                                "examples": [
                                    "inner-node-2",
                                    "inner-node-3"
                                ]
                            }
                        },
                        "outputNode": {
                          "type": "boolean",
                          "description": "is the output of this node visible on the macro node output"
                        }
                    }
                }
            }
        }
    }
}
