#
# Specifies third-party dependencies for 'services/web/server/src'
#
--constraint ../../../../requirements/constraints.txt

# intra-repo packages
#   - Input-requirements on intra-repo packages are tested using latest updates
#   - Added as constraints instead of requirements in order to avoid polluting base.txt
#   - Will be installed when prod.txt or dev.txt
#
--requirement ../../../../packages/models-library/requirements/_base.in
--requirement ../../../../packages/postgres-database/requirements/_base.in
--requirement ../../../../packages/settings-library/requirements/_base.in
# simcore-service-library[aiohttp]
--requirement ../../../../packages/service-library/requirements/_base.in
--requirement ../../../../packages/service-library/requirements/_aiohttp.in


# aiohttp + extensions
aiohttp
aiohttp_jinja2
aiohttp_session[secure]
aiohttp_security
aiohttp-swagger[performance]
gunicorn[setproctitle]


# web-sockets
# From 5.0.0, https://github.com/miguelgrinberg/python-socketio/blob/main/CHANGES.md
# test_resource_manager.py::test_websocket_resource_management fails because
# socket_id saved in redis does not correspond to client's sio
python-socketio~=4.6.1

# postgres db
aiopg[sa]
asyncpg

# i/o
aiofiles

# redis
aioredis
aioredlock

# RabbitMQ client
aio-pika

# email
aiosmtplib
jinja_app_loader


# data models
pydantic[email]

# security
cryptography
passlib

# json
orjson
jsondiff
json2html

# asyncio debug
aiodebug


# misc
change_case
expiringdict
semantic_version
tenacity

# import/export excel
parfive
openpyxl
python-magic


# SEE services/web/server/tests/unit/isolated/test_utils.py::test_yarl_url_compose_changed_with_latest_release
yarl<1.6


# FIXME: deprecated
trafaret==2.1.0
trafaret_config



# CONSTRAINTS ----------------------------------


# Could not find a version that matches jsonschema<4,<5.0.0,>=4.0.0 (from -r requirements/_base.in (line 90))
# There are incompatible versions in the resolved dependencies:
#   jsonschema (from -r requirements/../../../../packages/service-library/requirements/_aiohttp.in (line 14))
#   jsonschema<4 (from -c requirements/../../../../packages/service-library/requirements/././constraints.txt (line 27))
#   jsonschema<4 (from -c requirements/../../../../packages/service-library/requirements/./constraints.txt (line 27))
#   jsonschema<4 (from -r requirements/_base.in (line 90))
#   jsonschema (from openapi-spec-validator==0.3.1->openapi-core==0.12.0->-r requirements/../../../../packages/service-library/requirements/_aiohttp.in (line 8))
#   jsonschema<5.0.0,>=4.0.0 (from openapi-schema-validator==0.2.0->openapi-spec-validator==0.3.1->openapi-core==0.12.0->-r requirements/../../../../packages/service-library/requirements/_aiohttp.in (line 8))
jsonschema<4
openapi-schema-validator<0.2.0


# BREAKING CHANGES:
# -> tests will fail with
#   RuntimeError: There is already a profiler running.
#   You cannot run multiple profilers in the same thread or async context, unless you disable async support.
#
# SEE https://github.com/joerick/pyinstrument#v400release
pyinstrument<4
