# Overrides docker-compose.yml for development mode
# Usage:
#   docker-compose -f docker-compose.yml -f docker-compose.devel.yml ...
#
version: '3.7'
services:

  apihub:
    image: services_apihub:dev
    volumes:
      - '../api:/srv/http/api'

  director:
    image: services_director:dev
    environment:
      - REGISTRY_CACHING=False
      - SC_BOOT_MODE=debug-ptvsd
    volumes:
      - ./director:/devel/services/director
      - ../packages/service-library:/devel/packages/service-library
      - ../api:/devel/services/api
    stdin_open: true
    tty: true
    ports:
      - "3004:3000"

  webserver:
    image: services_webserver:dev
    volumes:
      - ./web/server:/devel/services/web/server
      - ./web/client/source-output:/devel/services/web/client
      - ../packages:/devel/packages
    stdin_open: true
    tty: true
    environment:
      - SC_BOOT_MODE=debug-ptvsd
    ports:
      - "3001:3000"

  sidecar:
    image: services_sidecar:dev
    volumes:
      - ./sidecar:/devel/services/sidecar
      - ./storage/client-sdk:/devel/services/storage/client-sdk
      - ../packages:/devel/packages

  storage:
    image: services_storage:dev
    volumes:
      - ./storage:/devel/services/storage
      - ../packages:/devel/packages
    environment:
      - SC_BOOT_MODE=debug-ptvsd
    ports:
      - "3003:3000"
    stdin_open: true
    tty: true
