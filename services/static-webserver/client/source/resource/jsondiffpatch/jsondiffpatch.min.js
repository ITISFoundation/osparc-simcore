(()=>{var we=Object.defineProperty;var Re=(n,e)=>{for(var t in e)we(n,t,{get:e[t],enumerable:!0})};var le={};Re(le,{DiffPatcher:()=>C,clone:()=>ke,create:()=>$e,dateReviver:()=>$,diff:()=>Oe,patch:()=>Me,reverse:()=>He,unpatch:()=>Le});function $(n,e){var t,r,i,s,l,a;if(typeof e!="string")return e;let f=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+-])(\d{2}):(\d{2}))$/.exec(e);return f?new Date(Date.UTC(Number.parseInt((t=f[1])!==null&&t!==void 0?t:"0",10),Number.parseInt((r=f[2])!==null&&r!==void 0?r:"0",10)-1,Number.parseInt((i=f[3])!==null&&i!==void 0?i:"0",10),Number.parseInt((s=f[4])!==null&&s!==void 0?s:"0",10),Number.parseInt((l=f[5])!==null&&l!==void 0?l:"0",10),Number.parseInt((a=f[6])!==null&&a!==void 0?a:"0",10),(f[7]?Number.parseInt(f[7]):0)||0)):e}function _e(n){var e;let t=/^\/(.*)\/([gimyu]*)$/.exec(n.toString());if(!t)throw new Error("Invalid RegExp");return new RegExp((e=t[1])!==null&&e!==void 0?e:"",t[2])}function N(n){if(typeof n!="object")return n;if(n===null)return null;if(Array.isArray(n))return n.map(N);if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp)return _e(n);let e={};for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=N(n[t]));return e}function ce(n,e){if(n.length===0)throw new Error(e||"Expected a non-empty array")}var pe=n=>n[n.length-1];var _=class{setResult(e){return this.result=e,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(e,t){return e.parent=this,typeof t<"u"&&(e.childName=t),e.root=this.root||this,e.options=e.options||this.options,this.children?(ce(this.children),pe(this.children).next=e,this.children.push(e)):(this.children=[e],this.nextAfterChildren=this.next||null,this.next=e),e.next=this,this}};var O=class extends _{constructor(e,t){super(),this.left=e,this.right=t,this.pipe="diff"}prepareDeltaResult(e){var t,r,i,s;if(typeof e=="object"&&(!((t=this.options)===null||t===void 0)&&t.omitRemovedValues&&Array.isArray(e)&&e.length>1&&(e.length===2||e[2]===0||e[2]===3)&&(e[0]=0),!((r=this.options)===null||r===void 0)&&r.cloneDiffValues)){let l=typeof((i=this.options)===null||i===void 0?void 0:i.cloneDiffValues)=="function"?(s=this.options)===null||s===void 0?void 0:s.cloneDiffValues:N;typeof e[0]=="object"&&(e[0]=l(e[0])),typeof e[1]=="object"&&(e[1]=l(e[1]))}return e}setResult(e){return this.prepareDeltaResult(e),super.setResult(e)}},R=O;var M=class extends _{constructor(e,t){super(),this.left=e,this.delta=t,this.pipe="patch"}},E=M;var L=class extends _{constructor(e){super(),this.delta=e,this.pipe="reverse"}},A=L;var H=class{constructor(e){this.name=e,this.filters=[]}process(e){if(!this.processor)throw new Error("add this pipe to a processor before using it");let t=this.debug,r=this.filters.length,i=e;for(let s=0;s<r;s++){let l=this.filters[s];if(l&&(t&&this.log(`filter: ${l.filterName}`),l(i),typeof i=="object"&&i.exiting)){i.exiting=!1;break}}!i.next&&this.resultCheck&&this.resultCheck(i)}log(e){console.log(`[jsondiffpatch] ${this.name} pipe, ${e}`)}append(...e){return this.filters.push(...e),this}prepend(...e){return this.filters.unshift(...e),this}indexOf(e){if(!e)throw new Error("a filter name is required");for(let t=0;t<this.filters.length;t++){let r=this.filters[t];if(r?.filterName===e)return t}throw new Error(`filter not found: ${e}`)}list(){return this.filters.map(e=>e.filterName)}after(e,...t){let r=this.indexOf(e);return this.filters.splice(r+1,0,...t),this}before(e,...t){let r=this.indexOf(e);return this.filters.splice(r,0,...t),this}replace(e,...t){let r=this.indexOf(e);return this.filters.splice(r,1,...t),this}remove(e){let t=this.indexOf(e);return this.filters.splice(t,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(e){return e===!1?(this.resultCheck=null,this):this.resultCheck?this:(this.resultCheck=t=>{if(!t.hasResult){console.log(t);let r=new Error(`${this.name} failed`);throw r.noResult=!0,r}},this)}},j=H;var k=class{constructor(e){this.selfOptions=e||{},this.pipes={}}options(e){return e&&(this.selfOptions=e),this.selfOptions}pipe(e,t){let r=t;if(typeof e=="string"){if(typeof r>"u")return this.pipes[e];this.pipes[e]=r}if(e&&e.name){if(r=e,r.processor===this)return r;this.pipes[r.name]=r}if(!r)throw new Error(`pipe is not defined: ${e}`);return r.processor=this,r}process(e,t){let r=e;r.options=this.options();let i=t||e.pipe||"default",s;for(;i;)typeof r.nextAfterChildren<"u"&&(r.next=r.nextAfterChildren,r.nextAfterChildren=null),typeof i=="string"&&(i=this.pipe(i)),i.process(r),s=i,i=null,r&&r.next&&(r=r.next,i=r.pipe||s);return r.hasResult?r.result:void 0}},me=k;var be=(n,e,t,r)=>n[t]===e[r],Fe=(n,e,t,r)=>{var i,s,l;let a=n.length,f=e.length,d,o,h=new Array(a+1);for(d=0;d<a+1;d++){let c=new Array(f+1);for(o=0;o<f+1;o++)c[o]=0;h[d]=c}for(h.match=t,d=1;d<a+1;d++){let c=h[d];if(c===void 0)throw new Error("LCS matrix row is undefined");let u=h[d-1];if(u===void 0)throw new Error("LCS matrix row is undefined");for(o=1;o<f+1;o++)t(n,e,d-1,o-1,r)?c[o]=((i=u[o-1])!==null&&i!==void 0?i:0)+1:c[o]=Math.max((s=u[o])!==null&&s!==void 0?s:0,(l=c[o-1])!==null&&l!==void 0?l:0)}return h},Ce=(n,e,t,r)=>{let i=e.length,s=t.length,l={sequence:[],indices1:[],indices2:[]};for(;i!==0&&s!==0;){if(n.match===void 0)throw new Error("LCS matrix match function is undefined");if(n.match(e,t,i-1,s-1,r))l.sequence.unshift(e[i-1]),l.indices1.unshift(i-1),l.indices2.unshift(s-1),--i,--s;else{let f=n[i];if(f===void 0)throw new Error("LCS matrix row is undefined");let d=f[s-1];if(d===void 0)throw new Error("LCS matrix value is undefined");let o=n[i-1];if(o===void 0)throw new Error("LCS matrix row is undefined");let h=o[s];if(h===void 0)throw new Error("LCS matrix value is undefined");d>h?--s:--i}}return l},Ne=(n,e,t,r)=>{let i=r||{},s=Fe(n,e,t||be,i);return Ce(s,n,e,i)},ye={get:Ne};var D=3;function De(n,e,t,r){for(let i=0;i<t;i++){let s=n[i];for(let l=0;l<r;l++){let a=e[l];if(i!==l&&s===a)return!0}}return!1}function P(n,e,t,r,i){let s=n[t],l=e[r];if(s===l)return!0;if(typeof s!="object"||typeof l!="object")return!1;let a=i.objectHash;if(!a)return i.matchByPosition&&t===r;i.hashCache1=i.hashCache1||[];let f=i.hashCache1[t];if(typeof f>"u"&&(i.hashCache1[t]=f=a(s,t)),typeof f>"u")return!1;i.hashCache2=i.hashCache2||[];let d=i.hashCache2[r];return typeof d>"u"&&(i.hashCache2[r]=d=a(l,r)),typeof d>"u"?!1:f===d}var W=function(e){var t,r,i,s,l;if(!e.leftIsArray)return;let a={objectHash:(t=e.options)===null||t===void 0?void 0:t.objectHash,matchByPosition:(r=e.options)===null||r===void 0?void 0:r.matchByPosition},f=0,d=0,o,h,c,u=e.left,m=e.right,g=u.length,w=m.length,b;for(g>0&&w>0&&!a.objectHash&&typeof a.matchByPosition!="boolean"&&(a.matchByPosition=!De(u,m,g,w));f<g&&f<w&&P(u,m,f,f,a);)o=f,b=new R(u[o],m[o]),e.push(b,o),f++;for(;d+f<g&&d+f<w&&P(u,m,g-1-d,w-1-d,a);)h=g-1-d,c=w-1-d,b=new R(u[h],m[c]),e.push(b,c),d++;let p;if(f+d===g){if(g===w){e.setResult(void 0).exit();return}for(p=p||{_t:"a"},o=f;o<w-d;o++)p[o]=[m[o]],e.prepareDeltaResult(p[o]);e.setResult(p).exit();return}if(f+d===w){for(p=p||{_t:"a"},o=f;o<g-d;o++){let v=`_${o}`;p[v]=[u[o],0,0],e.prepareDeltaResult(p[v])}e.setResult(p).exit();return}a.hashCache1=void 0,a.hashCache2=void 0;let fe=u.slice(f,g-d),oe=m.slice(f,w-d),F=ye.get(fe,oe,P,a),I=[];for(p=p||{_t:"a"},o=f;o<g-d;o++)if(F.indices1.indexOf(o-f)<0){let v=`_${o}`;p[v]=[u[o],0,0],e.prepareDeltaResult(p[v]),I.push(o)}let ae=!0;!((i=e.options)===null||i===void 0)&&i.arrays&&e.options.arrays.detectMove===!1&&(ae=!1);let de=!1;!((l=(s=e.options)===null||s===void 0?void 0:s.arrays)===null||l===void 0)&&l.includeValueOnMove&&(de=!0);let ue=I.length;for(o=f;o<w-d;o++){let v=F.indices2.indexOf(o-f);if(v<0){let he=!1;if(ae&&ue>0)for(let x=0;x<ue;x++){h=I[x];let T=h===void 0?void 0:p[`_${h}`];if(h!==void 0&&T&&P(fe,oe,h-f,o-f,a)){T.splice(1,2,o,D),T.splice(1,2,o,D),de||(T[0]=""),c=o,b=new R(u[h],m[c]),e.push(b,c),I.splice(x,1),he=!0;break}}he||(p[o]=[m[o]],e.prepareDeltaResult(p[o]))}else{if(F.indices1[v]===void 0)throw new Error(`Invalid indexOnArray2: ${v}, seq.indices1: ${F.indices1}`);if(h=F.indices1[v]+f,F.indices2[v]===void 0)throw new Error(`Invalid indexOnArray2: ${v}, seq.indices2: ${F.indices2}`);c=F.indices2[v]+f,b=new R(u[h],m[c]),e.push(b,c)}}e.setResult(p).exit()};W.filterName="arrays";var ve={numerically(n,e){return n-e},numericallyBy(n){return(e,t)=>e[n]-t[n]}},S=function(e){var t;if(!e.nested)return;let r=e.delta;if(r._t!=="a")return;let i,s,l=r,a=e.left,f=[],d=[],o=[];for(i in l)if(i!=="_t")if(i[0]==="_"){let u=i;if(l[u]!==void 0&&(l[u][2]===0||l[u][2]===D))f.push(Number.parseInt(i.slice(1),10));else throw new Error(`only removal or move can be applied at original array indices, invalid diff type: ${(t=l[u])===null||t===void 0?void 0:t[2]}`)}else{let u=i;l[u].length===1?d.push({index:Number.parseInt(u,10),value:l[u][0]}):o.push({index:Number.parseInt(u,10),delta:l[u]})}for(f=f.sort(ve.numerically),i=f.length-1;i>=0;i--){if(s=f[i],s===void 0)continue;let u=l[`_${s}`],m=a.splice(s,1)[0];u?.[2]===D&&d.push({index:u[1],value:m})}d=d.sort(ve.numericallyBy("index"));let h=d.length;for(i=0;i<h;i++){let u=d[i];u!==void 0&&a.splice(u.index,0,u.value)}let c=o.length;if(c>0)for(i=0;i<c;i++){let u=o[i];if(u===void 0)continue;let m=new E(a[u.index],u.delta);e.push(m,u.index)}if(!e.children){e.setResult(a).exit();return}e.exit()};S.filterName="arrays";var B=function(e){if(!e||!e.children||e.delta._t!=="a")return;let r=e.left,i=e.children.length;for(let s=0;s<i;s++){let l=e.children[s];if(l===void 0)continue;let a=l.childName;r[a]=l.result}e.setResult(r).exit()};B.filterName="arraysCollectChildren";var V=function(e){if(!e.nested){let i=e.delta;if(i[2]===D){let s=i;e.newName=`_${s[1]}`,e.setResult([s[0],Number.parseInt(e.childName.substring(1),10),D]).exit()}return}let t=e.delta;if(t._t!=="a")return;let r=t;for(let i in r){if(i==="_t")continue;let s=new A(r[i]);e.push(s,i)}e.exit()};V.filterName="arrays";var Ee=(n,e,t)=>{if(typeof e=="string"&&e[0]==="_")return Number.parseInt(e.substring(1),10);if(Array.isArray(t)&&t[2]===0)return`_${e}`;let r=+e;for(let i in n){let s=n[i];if(Array.isArray(s))if(s[2]===D){let l=Number.parseInt(i.substring(1),10),a=s[1];if(a===+e)return l;l<=r&&a>r?r++:l>=r&&a<r&&r--}else s[2]===0?Number.parseInt(i.substring(1),10)<=r&&r++:s.length===1&&Number.parseInt(i,10)<=r&&r--}return r},q=n=>{if(!n||!n.children)return;let e=n.delta;if(e._t!=="a")return;let t=e,r=n.children.length,i={_t:"a"};for(let s=0;s<r;s++){let l=n.children[s];if(l===void 0)continue;let a=l.newName;if(typeof a>"u"){if(l.childName===void 0)throw new Error("child.childName is undefined");a=Ee(t,l.childName,l.result)}i[a]!==l.result&&(i[a]=l.result)}n.setResult(i).exit()};q.filterName="arraysCollectChildren";var X=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};X.filterName="dates";var U=n=>{if(!n||!n.children)return;let e=n.children.length,t=n.result;for(let r=0;r<e;r++){let i=n.children[r];if(i!==void 0&&!(typeof i.result>"u")){if(t=t||{},i.childName===void 0)throw new Error("diff child.childName is undefined");t[i.childName]=i.result}}t&&n.leftIsArray&&(t._t="a"),n.setResult(t).exit()};U.filterName="collectChildren";var G=n=>{var e;if(n.leftIsArray||n.leftType!=="object")return;let t=n.left,r=n.right,i=(e=n.options)===null||e===void 0?void 0:e.propertyFilter;for(let s in t){if(!Object.prototype.hasOwnProperty.call(t,s)||i&&!i(s,n))continue;let l=new R(t[s],r[s]);n.push(l,s)}for(let s in r)if(Object.prototype.hasOwnProperty.call(r,s)&&!(i&&!i(s,n))&&typeof t[s]>"u"){let l=new R(void 0,r[s]);n.push(l,s)}if(!n.children||n.children.length===0){n.setResult(void 0).exit();return}n.exit()};G.filterName="objects";var Y=function(e){if(!e.nested)return;let t=e.delta;if(t._t)return;let r=t;for(let i in r){let s=new E(e.left[i],r[i]);e.push(s,i)}e.exit()};Y.filterName="objects";var Z=function(e){if(!e||!e.children||e.delta._t)return;let r=e.left,i=e.children.length;for(let s=0;s<i;s++){let l=e.children[s];if(l===void 0)continue;let a=l.childName;Object.prototype.hasOwnProperty.call(e.left,a)&&l.result===void 0?delete r[a]:r[a]!==l.result&&(r[a]=l.result)}e.setResult(r).exit()};Z.filterName="collectChildren";var z=function(e){if(!e.nested||e.delta._t)return;let r=e.delta;for(let i in r){let s=new A(r[i]);e.push(s,i)}e.exit()};z.filterName="objects";var J=n=>{if(!n||!n.children||n.delta._t)return;let t=n.children.length,r={};for(let i=0;i<t;i++){let s=n.children[i];if(s===void 0)continue;let l=s.childName;r[l]!==s.result&&(r[l]=s.result)}n.setResult(r).exit()};J.filterName="collectChildren";var K=null;function ge(n,e){var t;if(!K){let r;if(!((t=n?.textDiff)===null||t===void 0)&&t.diffMatchPatch)r=new n.textDiff.diffMatchPatch;else{if(!e)return null;let i=new Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw i.diff_match_patch_not_found=!0,i}K={diff:(i,s)=>r.patch_toText(r.patch_make(i,s)),patch:(i,s)=>{let l=r.patch_apply(r.patch_fromText(s),i);for(let a of l[1])if(!a){let f=new Error("text patch failed");throw f.textPatchFailed=!0,f}return l[0]}}}return K}var Q=function(e){var t,r;if(e.leftType!=="string")return;let i=e.left,s=e.right,l=((r=(t=e.options)===null||t===void 0?void 0:t.textDiff)===null||r===void 0?void 0:r.minLength)||60;if(i.length<l||s.length<l){e.setResult([i,s]).exit();return}let a=ge(e.options);if(!a){e.setResult([i,s]).exit();return}let f=a.diff;e.setResult([f(i,s),0,2]).exit()};Q.filterName="texts";var ee=function(e){if(e.nested)return;let t=e.delta;if(t[2]!==2)return;let r=t,i=ge(e.options,!0).patch;e.setResult(i(e.left,r[0])).exit()};ee.filterName="texts";var Te=n=>{var e,t,r;let i=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,s=n.split(`
`);for(let l=0;l<s.length;l++){let a=s[l];if(a===void 0)continue;let f=a.slice(0,1);if(f==="@"){let d=i.exec(a);if(d!==null){let o=l;s[o]=`@@ -${d[3]},${d[4]} +${d[1]},${d[2]} @@`}}else if(f==="+"){if(s[l]=`-${(e=s[l])===null||e===void 0?void 0:e.slice(1)}`,((t=s[l-1])===null||t===void 0?void 0:t.slice(0,1))==="+"){let d=s[l];s[l]=s[l-1],s[l-1]=d}}else f==="-"&&(s[l]=`+${(r=s[l])===null||r===void 0?void 0:r.slice(1)}`)}return s.join(`
`)},te=function(e){if(e.nested)return;let t=e.delta;if(t[2]!==2)return;let r=t;e.setResult([Te(r[0]),0,2]).exit()};te.filterName="texts";var re=function(e){if(e.left===e.right){e.setResult(void 0).exit();return}if(typeof e.left>"u"){if(typeof e.right=="function")throw new Error("functions are not supported");e.setResult([e.right]).exit();return}if(typeof e.right>"u"){e.setResult([e.left,0,0]).exit();return}if(typeof e.left=="function"||typeof e.right=="function")throw new Error("functions are not supported");if(e.leftType=e.left===null?"null":typeof e.left,e.rightType=e.right===null?"null":typeof e.right,e.leftType!==e.rightType){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="boolean"||e.leftType==="number"){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="object"&&(e.leftIsArray=Array.isArray(e.left)),e.rightType==="object"&&(e.rightIsArray=Array.isArray(e.right)),e.leftIsArray!==e.rightIsArray){e.setResult([e.left,e.right]).exit();return}e.left instanceof RegExp&&(e.right instanceof RegExp?e.setResult([e.left.toString(),e.right.toString()]).exit():e.setResult([e.left,e.right]).exit())};re.filterName="trivial";var ie=function(e){if(typeof e.delta>"u"){e.setResult(e.left).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;let t=e.delta;if(t.length===1){e.setResult(t[0]).exit();return}if(t.length===2){if(e.left instanceof RegExp){let r=/^\/(.*)\/([gimyu]+)$/.exec(t[1]);if(r?.[1]){e.setResult(new RegExp(r[1],r[2])).exit();return}}e.setResult(t[1]).exit();return}t.length===3&&t[2]===0&&e.setResult(void 0).exit()};ie.filterName="trivial";var ne=function(e){if(typeof e.delta>"u"){e.setResult(e.delta).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;let t=e.delta;if(t.length===1){e.setResult([t[0],0,0]).exit();return}if(t.length===2){e.setResult([t[1],t[0]]).exit();return}t.length===3&&t[2]===0&&e.setResult([t[0]]).exit()};ne.filterName="trivial";var se=class{constructor(e){this.processor=new me(e),this.processor.pipe(new j("diff").append(U,re,X,Q,G,W).shouldHaveResult()),this.processor.pipe(new j("patch").append(Z,B,ie,ee,Y,S).shouldHaveResult()),this.processor.pipe(new j("reverse").append(J,q,ne,te,z,V).shouldHaveResult())}options(e){return this.processor.options(e)}diff(e,t){return this.processor.process(new R(e,t))}patch(e,t){return this.processor.process(new E(e,t))}reverse(e){return this.processor.process(new A(e))}unpatch(e,t){return this.patch(e,this.reverse(t))}clone(e){return N(e)}},C=se;function $e(n){return new C(n)}var y;function Oe(n,e){return y||(y=new C),y.diff(n,e)}function Me(n,e){return y||(y=new C),y.patch(n,e)}function Le(n,e){return y||(y=new C),y.unpatch(n,e)}function He(n){return y||(y=new C),y.reverse(n)}function ke(n){return y||(y=new C),y.clone(n)}window.jsondiffpatch=le;})();
